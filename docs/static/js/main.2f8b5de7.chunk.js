(this["webpackJsonpreact-modify-demo"]=this["webpackJsonpreact-modify-demo"]||[]).push([[0],{52:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(18),s=n.n(a),o=n(2),u=n(11),i=n(3),l=n(8),p=n(7),d=n.n(p),f=n(20),b=n(9),j=n(34),h=n(29),x=n(31),O=n.n(x),m=n(32),v=n.n(m),w=n(35),k=(n(52),n(1)),g=function(e){try{return globalThis.XLSX.read(e,{WTF:!0,dense:!0})}catch(t){return t instanceof Error?t:new Error(t)}},y=1e4,S=v()(O.a);function C(e,t){var n,r=b.utils.sheet_to_json(e[t],{header:1}),c=[],a=Object(l.a)(r);try{for(a.s();!(n=a.n()).done;){var s=n.value,o=Object.keys(s);o.length>c.length&&(c=o.map((function(e){return{key:e,name:b.utils.encode_col(+e),editor:f.a}})))}}catch(u){a.e(u)}finally{a.f()}return{rows:r,columns:c}}var E=["xlsx","xlsb","csv","html"];function T(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)([]),s=Object(i.a)(a,2),l=s[0],p=s[1],x=Object(r.useState)({}),O=Object(i.a)(x,2),m=O[0],v=O[1],T=Object(r.useState)([]),_=Object(i.a)(T,2),B=_[0],z=_[1],D=Object(r.useState)(""),F=Object(i.a)(D,2),N=F[0],L=F[1],I=Object(r.useState)(!1),P=Object(i.a)(I,2),R=P[0],W=P[1],J=Object(r.useRef)(null),M=Object(h.a)(g,{remoteDependencies:["https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"]}),U=Object(i.a)(M,2),X=U[0],A=U[1],H=Object(r.useCallback)(function(){var e=Object(u.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!R){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,W(!0);case 4:$(t[0]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[$,R]),q=Object(w.a)({onDrop:H}),G=q.getRootProps,K=q.getInputProps,Q=q.isDragActive;function V(e){return Y.apply(this,arguments)}function Y(){return Y=Object(u.a)(d.a.mark((function e(t){var r,a,s,o,u=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(u.length>1&&void 0!==u[1])||u[1],e.next=3,W(!0);case 3:return r&&(m[N]=b.utils.json_to_sheet(n,{header:l.map((function(e){return e.key})),skipHeader:!0})),a=C(m,t),s=a.rows,o=a.columns,e.next=7,c(s);case 7:return e.next=9,p(o);case 9:return e.next=11,L(t);case 11:return e.next=13,W(!1);case 13:case"end":return e.stop()}}),e)}))),Y.apply(this,arguments)}function Z(){return(Z=Object(u.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W(!0);case 2:if(r=null===(n=t.target.files)||void 0===n?void 0:n[0]){e.next=8;break}return null!==J&&void 0!==J&&J.current&&(J.current.value=""),e.next=7,W(!1);case 7:return e.abrupt("return",e.sent);case 8:return e.next=10,$(r);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e){return ee.apply(this,arguments)}function ee(){return(ee=Object(u.a)(d.a.mark((function e(t){var n,r,a,s,o,i,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.size>1048576)){e.next=9;break}return e.next=3,S.fire({icon:"warning",title:"Large File",text:"File is ".concat(t.size/1048576>>>0," MB and reading may be slow.  Should we proceed?"),confirmButtonText:"Continue",showCancelButton:!0,cancelButtonText:"Stop"});case 3:if(e.sent.isConfirmed){e.next=9;break}return null!==J&&void 0!==J&&J.current&&(J.current.value=""),e.next=8,W(!1);case 8:case 24:return e.abrupt("return",e.sent);case 9:return n=setTimeout(Object(u.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.kill();case 2:return e.next=4,S.fire({icon:"error",title:"Timeout",text:"Stopped reading after ".concat(10," seconds"),footer:Object(k.jsx)("a",{href:"mailto:oss@sheetjs.com?subject=Public Demo Error&body=Timeout on file of size ".concat(t.size," bytes"),children:"We would appreciate the feedback"})});case 4:return null!==J&&void 0!==J&&J.current&&(J.current.value=""),e.next=7,W(!1);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)}))),y),e.next=12,t.arrayBuffer();case 12:return r=e.sent,a=new Error(""),e.next=16,X(r);case 16:if(!((a=e.sent)instanceof Error)){e.next=25;break}return console.log(a),e.next=21,S.fire({icon:"error",title:"This file does not appear to be a valid spreadsheet",text:"Library Error: ".concat(a.message||a),footer:Object(k.jsx)("a",{href:"mailto:oss@sheetjs.com?subject=Public Demo Error&body=".concat(encodeURIComponent(a.message)),children:"We would appreciate the feedback"})});case 21:return null!==J&&void 0!==J&&J.current&&(J.current.value=""),e.next=24,W(!1);case 25:return e.next=27,v(a.Sheets);case 27:return e.next=29,z(a.SheetNames);case 29:return s=a.SheetNames[0],o=C(a.Sheets,s),i=o.rows,l=o.columns,e.next=33,c(i);case 33:return e.next=35,p(l);case 35:return e.next=37,L(s);case 37:return clearTimeout(n),null!==J&&void 0!==J&&J.current&&(J.current.value=""),e.next=41,W(!1);case 41:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(){return(te=Object(u.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W(!0);case 2:return n=b.utils.book_new(),B.forEach((function(e){b.utils.book_append_sheet(n,m[e],e)})),Object(b.writeFile)(n,"sheet."+t),e.next=7,W(!1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(){return(ne=Object(u.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=parseInt(t.target.value,10),e.next=3,V(B[n]);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("input",{type:"file",onChangeCapture:function(e){return Z.apply(this,arguments)},ref:J,disabled:R}),Object(k.jsx)(j.BeatLoader,{loading:R,size:10}),!R&&Object(k.jsxs)("div",Object(o.a)(Object(o.a)({className:"dropzone"},G()),{},{children:[Object(k.jsx)("input",Object(o.a)({className:"dropinput"},K)),R?Object(k.jsx)("p",{children:"Loading file ..."}):Q?Object(k.jsx)("p",{children:"Drop files here!"}):Object(k.jsx)("p",{children:"... or drag and drop files here."})]})),B.length>0&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("p",{children:["Use the dropdown to switch to a worksheet:\xa0",Object(k.jsx)("select",{id:"wselect",onChange:function(e){return ne.apply(this,arguments)},children:B.map((function(e,t){return Object(k.jsx)("option",{value:t,children:e},e)}))})]}),Object(k.jsx)("div",{className:"flex-cont",children:Object(k.jsxs)("b",{children:["Current Sheet: ",N]})}),Object(k.jsx)(f.b,{columns:l,rows:n,onRowsChange:c}),Object(k.jsx)("p",{children:"Click one of the buttons to create a new file with the modified data"}),Object(k.jsx)("div",{className:"flex-cont",children:E.map((function(e){return Object(k.jsxs)("button",{onClick:function(){return function(e){return te.apply(this,arguments)}(e)},children:["export [.",e,"]"]},e)}))})]})]})}n(84);s.a.render(Object(k.jsx)(c.a.StrictMode,{children:Object(k.jsx)(T,{})}),document.getElementById("root"))}},[[85,1,2]]]);
//# sourceMappingURL=main.2f8b5de7.chunk.js.map