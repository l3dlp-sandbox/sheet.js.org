(this["webpackJsonpreact-modify-demo"]=this["webpackJsonpreact-modify-demo"]||[]).push([[0],{51:function(e,t,r){},83:function(e,t,r){},84:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r.n(n),a=r(18),s=r.n(a),o=r(2),u=r(7),i=r(11),l=r(3),b=r(8),j=r(20),p=r(9),d=r(34),f=r(29),h=r(31),x=r.n(h),O=r(32),m=r.n(O),v=r(35),w=(r(51),r(1)),k=function(e){try{return globalThis.XLSX.read(e,{WTF:!0,dense:!0,cellDates:!0})}catch(t){return t instanceof Error?t:new Error(t)}},g=1e4,y=m()(x.a);function S(e,t){var r,n=p.utils.sheet_to_json(e[t],{header:1,raw:!1}),c=[],a=Object(b.a)(n);try{for(a.s();!(r=a.n()).done;){var s=r.value,o=Object.keys(s);o.length>c.length&&(c=o.map((function(e){return{key:e,name:p.utils.encode_col(+e),editor:j.a}})))}}catch(u){a.e(u)}finally{a.f()}return{rows:n,columns:c}}var C=["xlsx","xlsb","csv","html"];function E(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),r=t[0],c=t[1],a=Object(n.useState)([]),s=Object(l.a)(a,2),b=s[0],h=s[1],x=Object(n.useState)({}),O=Object(l.a)(x,2),m=O[0],E=O[1],T=Object(n.useState)([]),_=Object(l.a)(T,2),B=_[0],D=_[1],z=Object(n.useState)(""),F=Object(l.a)(z,2),N=F[0],L=F[1],I=Object(n.useState)(!1),P=Object(l.a)(I,2),R=P[0],W=P[1],J=Object(n.useRef)(null),M=Object(f.a)(k,{remoteDependencies:["https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"]}),U=Object(l.a)(M,2),X=U[0],A=U[1],H=Object(n.useCallback)(function(){var e=Object(i.a)(Object(u.a)().mark((function e(t){return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!R){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,W(!0);case 4:$(t[0]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[$,R]),q=Object(v.a)({onDrop:H}),G=q.getRootProps,K=q.getInputProps,Q=q.isDragActive;function V(e){return Y.apply(this,arguments)}function Y(){return Y=Object(i.a)(Object(u.a)().mark((function e(t){var n,a,s,o,i=arguments;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],e.next=3,W(!0);case 3:return n&&(m[N]=p.utils.json_to_sheet(r,{header:b.map((function(e){return e.key})),skipHeader:!0})),a=S(m,t),s=a.rows,o=a.columns,e.next=7,c(s);case 7:return e.next=9,h(o);case 9:return e.next=11,L(t);case 11:return e.next=13,W(!1);case 13:case"end":return e.stop()}}),e)}))),Y.apply(this,arguments)}function Z(){return(Z=Object(i.a)(Object(u.a)().mark((function e(t){var r,n;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W(!0);case 2:if(n=null===(r=t.target.files)||void 0===r?void 0:r[0]){e.next=8;break}return null!==J&&void 0!==J&&J.current&&(J.current.value=""),e.next=7,W(!1);case 7:return e.abrupt("return",e.sent);case 8:return e.next=10,$(n);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e){return ee.apply(this,arguments)}function ee(){return(ee=Object(i.a)(Object(u.a)().mark((function e(t){var r,n,a,s,o,l,b;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.size>1048576)){e.next=9;break}return e.next=3,y.fire({icon:"warning",title:"Large File",text:"File is ".concat(t.size/1048576>>>0," MB and reading may be slow.  Should we proceed?"),confirmButtonText:"Continue",showCancelButton:!0,cancelButtonText:"Stop"});case 3:if(e.sent.isConfirmed){e.next=9;break}return null!==J&&void 0!==J&&J.current&&(J.current.value=""),e.next=8,W(!1);case 8:case 24:return e.abrupt("return",e.sent);case 9:return r=setTimeout(Object(i.a)(Object(u.a)().mark((function e(){return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.kill();case 2:return e.next=4,y.fire({icon:"error",title:"Timeout",text:"Stopped reading after ".concat(10," seconds"),footer:Object(w.jsx)("a",{href:"mailto:oss@sheetjs.com?subject=Public Demo Error&body=Timeout on file of size ".concat(t.size," bytes"),children:"We would appreciate the feedback"})});case 4:return null!==J&&void 0!==J&&J.current&&(J.current.value=""),e.next=7,W(!1);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)}))),g),e.next=12,t.arrayBuffer();case 12:return n=e.sent,a=new Error(""),e.next=16,X(n);case 16:if(!((a=e.sent)instanceof Error)){e.next=25;break}return console.log(a),e.next=21,y.fire({icon:"error",title:"This file does not appear to be a valid spreadsheet",text:"Library Error: ".concat(a.message||a),footer:Object(w.jsx)("a",{href:"mailto:oss@sheetjs.com?subject=Public Demo Error&body=".concat(encodeURIComponent(a.message)),children:"We would appreciate the feedback"})});case 21:return null!==J&&void 0!==J&&J.current&&(J.current.value=""),e.next=24,W(!1);case 25:return e.next=27,E(a.Sheets);case 27:return e.next=29,D(a.SheetNames);case 29:return s=a.SheetNames[0],o=S(a.Sheets,s),l=o.rows,b=o.columns,e.next=33,c(l);case 33:return e.next=35,h(b);case 35:return e.next=37,L(s);case 37:return clearTimeout(r),null!==J&&void 0!==J&&J.current&&(J.current.value=""),e.next=41,W(!1);case 41:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(){return(te=Object(i.a)(Object(u.a)().mark((function e(t){var r;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W(!0);case 2:return r=p.utils.book_new(),B.forEach((function(e){p.utils.book_append_sheet(r,m[e],e)})),Object(p.writeFile)(r,"sheet."+t),e.next=7,W(!1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(){return(re=Object(i.a)(Object(u.a)().mark((function e(t){var r;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=parseInt(t.target.value,10),e.next=3,V(B[r]);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("input",{type:"file",onChangeCapture:function(e){return Z.apply(this,arguments)},ref:J,disabled:R}),Object(w.jsx)(d.BeatLoader,{loading:R,size:10}),!R&&Object(w.jsxs)("div",Object(o.a)(Object(o.a)({className:"dropzone"},G()),{},{children:[Object(w.jsx)("input",Object(o.a)({className:"dropinput"},K)),R?Object(w.jsx)("p",{children:"Loading file ..."}):Q?Object(w.jsx)("p",{children:"Drop files here!"}):Object(w.jsx)("p",{children:"... or drag and drop files here."})]})),B.length>0&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)("p",{children:["Use the dropdown to switch to a worksheet:\xa0",Object(w.jsx)("select",{id:"wselect",onChange:function(e){return re.apply(this,arguments)},children:B.map((function(e,t){return Object(w.jsx)("option",{value:t,children:e},e)}))})]}),Object(w.jsx)("div",{className:"flex-cont",children:Object(w.jsxs)("b",{children:["Current Sheet: ",N]})}),Object(w.jsx)(j.b,{columns:b,rows:r,onRowsChange:c}),Object(w.jsx)("p",{children:"Click one of the buttons to create a new file with the modified data"}),Object(w.jsx)("div",{className:"flex-cont",children:C.map((function(e){return Object(w.jsxs)("button",{onClick:function(){return function(e){return te.apply(this,arguments)}(e)},children:["export [.",e,"]"]},e)}))})]})]})}r(83);s.a.render(Object(w.jsx)(c.a.StrictMode,{children:Object(w.jsx)(E,{})}),document.getElementById("root"))}},[[84,1,2]]]);
//# sourceMappingURL=main.577bd699.chunk.js.map